/*
 * Core - JavaScript Utilities
 *
 * Licensed under the new BSD License.
 * Copyright 2008, Bram Stein
 * All rights reserved.
 */
(function(){Object.extend=function(F){var E=1,D,C=arguments.length;for(;E<C;E+=1){for(D in arguments[E]){if(arguments[E].hasOwnProperty(D)&&(!F[D]||F.propertyIsEnumerable(D))){F[D]=arguments[E][D]}}}return F};function A(C){return Object.prototype.toString.apply(C)}function B(D){function C(){}C.prototype=D;return new C()}Object.extend(Object,{isAtom:function(C){return((typeof C!=="object"||C===null)&&typeof C!=="function")||Object.isBoolean(C)},isBoolean:function(C){return C!==null&&typeof C==="boolean"},isArray:function(C){return A(C)==="[object Array]"},isObject:function(C){return A(C)==="[object Object]"},isFunction:function(C){return typeof C==="function"},filter:function(F,C,H){var D,E={},G;H=H||F;for(D in F){if(F.hasOwnProperty(D)){G=F[D];if(C.call(H,G,D,F)){E[D]=G}}}return E},map:function(F,C,G){var D,E={};G=G||F;for(D in F){if(F.hasOwnProperty(D)){E[D]=C.call(G,F[D],D,F)}}return E},forEach:function(E,C,F){var D;F=F||E;for(D in E){if(E.hasOwnProperty(D)){C.call(F,E[D],D,E)}}},every:function(E,C,F){var D;F=F||E;for(D in E){if(E.hasOwnProperty(D)&&!C.call(F,E[D],D,E)){return false}}return true},some:function(E,C,F){var D;F=F||E;for(D in E){if(E.hasOwnProperty(D)&&C.call(F,E[D],D,E)){return true}}return false},isEmpty:function(C){return Object.every(C,function(E,D){return !C.hasOwnProperty(D)})},clone:B,equals:function(E,C){var D=0;return E&&C&&Object.isObject(E)&&Object.isObject(C)&&Object.every(E,function(G,F){D+=1;return C.hasOwnProperty(F)&&((Object.isObject(G)&&Object.equals(G,C[F]))||G.equals(C[F]))})&&D===Object.reduce(C,function(F){return(F+=1)},0)},reduce:function(G,C,E){var F,D;if(Object.isEmpty(G)&&E===undefined){throw new TypeError()}if(E===undefined){for(F in G){if(G.hasOwnProperty(F)){E=G[F];D=F;break}}}for(F in G){if(G.hasOwnProperty(F)&&F!==D){E=C.call(null,E,G[F],F,G)}}return E}});Object.extend(Array.prototype,{append:function(){var D=0,C=arguments.length;for(;D<C;D+=1){this.push.apply(this,arguments[D])}return this},clone:B,top:function(){return this[this.length-1]},equals:function(C){return C&&this.length===C.length&&this.every(function(E,D){return(Object.isObject(E)&&Object.equals(E,C[D]))||E.equals(C[D])})},contains:function(C){return this.indexOf(C)!==-1},filter:function(D,H){var E=0,F=[],G,C=this.length;H=H||this;for(;E<C;E+=1){if(E in this){G=this[E];if(D.call(H,G,E,this)){F.push(G)}}}return F},map:function(D,G){var E=0,F=[],C=this.length;G=G||this;for(;E<C;E+=1){if(E in this){F[E]=D.call(G,this[E],E,this)}}return F},forEach:function(D,F){var E=0,C=this.length;F=F||this;for(;E<C;E+=1){if(E in this){D.call(F,this[E],E,this)}}},every:function(D,F){var E=0,C=this.length;F=F||this;for(;E<C;E+=1){if(E in this&&!D.call(F,this[E],E,this)){return false}}return true},some:function(D,F){var E=0,C=this.length;F=F||this;for(;E<C;E+=1){if(E in this&&D.call(F,this[E],E,this)){return true}}return false},indexOf:function(D,E){var C=this.length;E=Number(E)||0;E=(E<0)?Math.ceil(E):Math.floor(E);E=(E<0)?E+C:E;for(;E<C;E+=1){if(E in this&&this[E]===D){return E}}return -1},lastIndexOf:function(D,E){var C=this.length;E=Number(E)||(C-1);E=(E<0)?Math.ceil(E):Math.floor(E);E=(E<0)?E+C:E;E=(E>=C)?C:E;for(;E>-1;E-=1){if(E in this&&this[E]===D){return E}}return -1},reduce:function(D,E){var F=0,C=this.length;if(C===0&&E===undefined){throw new TypeError()}if(E===undefined){do{if(F in this){E=this[F];F+=1;break}F+=1;if(F>=C){throw new TypeError()}}while(true)}for(;F<C;F+=1){if(F in this){E=D.call(null,E,this[F],F,this)}}return E},reduceRight:function(D,E){var C=this.length,F=C-1;if(C===0&&E===undefined){throw new TypeError()}if(E===undefined){do{if(F in this){E=this[F];F-=1;break}F-=1;if(F<0){throw new TypeError()}}while(true)}for(;F>=0;F-=1){if(F in this){E=D.call(null,E,this[F],F,this)}}return E}});[Boolean,String,Function].forEach(function(C){Object.extend(C.prototype,{equals:function(D){return this==D}})});Object.extend(Number.prototype,{equals:function(C){return this==C||isNaN(this)&&isNaN(C)}});Object.extend(Date.prototype,{equals:function(C){return this.valueOf()===C.valueOf()}});Object.extend(RegExp.prototype,{equals:function(C){return C instanceof RegExp&&this.source===C.source&&this.global===C.global&&this.ignoreCase===C.ignoreCase&&this.multiline===C.multiline}});["reduce","reduceRight","equals","contains","append","top","filter","map","forEach","some","every","indexOf","lastIndexOf","join","sort","reverse","push","pop","shift","unshift","splice","concat","slice"].forEach(function(C){if(!(C in Array)&&C in Array.prototype){Array[C]=function(D){return this.prototype[C].apply(D,Array.prototype.slice.call(arguments,1))}}});Object.extend(Function.prototype,{bind:function(C){var D=this;return function(){return D.apply(C,arguments)}},curry:function(){var D=this,C=Array.slice(arguments,0);if(arguments.length===0){return this}return function(){return D.apply(this,C.concat(Array.slice(arguments,0)))}},defaults:function(){var D=this,C=arguments;return function(){var F=arguments.length,E=C.length;for(;F<E;F+=1){arguments[F]=C[F]}arguments.length=F;return D.apply(this,arguments)}},chain:function(C){C=C||this;return function(){var D=C.apply(this,arguments);return D===undefined?this:D}}});Object.extend(Math,{ceilInt:function(E,C){var D=Math.pow(10,C||1);return Math.ceil(E/D)*D},log10:function(C){return Math.log(C)/Math.log(10)},digits:function(C){return Math.floor(Math.log10(Math.abs(C!==0?C:1)))+1}})})();